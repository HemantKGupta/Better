import java.util.Arrays;

public class PatternSearch06_FA_Better {
	private static final int NO_OF_CHARS = 4;

	public static void main(String[] args) {
		//char[] txt = "AABAACAADAABAAABAA".toCharArray();
		char[] pat = "0101020".toCharArray();
		//search(pa;t, txt);
		int M =  pat.length;
		int[][] TF = new int[M + 1][NO_OF_CHARS];
		computeTransFun(pat,M, TF);
	}

	public static void computeTransFun(char[] pat, int M, int TF[][]) {
		int i, lps = 0, x;

		// Fill entries in first row
		for (x = 0; x < NO_OF_CHARS; x++)
			TF[0][x] = 0;
		
		print2DArray(TF);
		System.out.println("pat[0]: "+pat[0]);
		TF[0][pat[0]] = 1;

		// Fill entries in other rows
		for (i = 1; i <= M; i++) {
			// Copy values from row at index lps
			for (x = 0; x < NO_OF_CHARS; x++)
				TF[i][x] = TF[lps][x];

			// Update the entry corresponding to this character
			TF[i][pat[i]] = i + 1;

			// Update lps for next row to be filled
			if (i < M)
				lps = TF[lps][pat[i]];
			System.out.println("lps is: "+lps);
		}
	}

	/* Prints all occurrences of pat in txt */
	public static void search(char[] pat, char[] txt) {
		int M = pat.length;
		int N = txt.length;

		int[][] TF = new int[M + 1][NO_OF_CHARS];

		computeTransFun(pat, M, TF);
		//System.out.println(Arrays.toString(TF));

		// process text over FA.
		int i, j = 0;
		for (i = 0; i < N; i++) {
			j = TF[j][txt[i]];
			if (j == M) {
				System.out.printf("\n pattern found at index %d", i - M + 1);
			}
		}
	}
	
	public static void print2DArray(int[][] arr){
		for (int i=0;i< arr.length;i++){
			System.out.println();
			for(int j= 0;j<arr[0].length;j++){
				System.out.print(arr[i][j]+" ");
			}
		}
		System.out.println();
		
	}

}
